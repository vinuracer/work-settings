"use strict";var bo=function(){var f=void 0;function r(){f||(f={meeting:mainAppHtmlWindow.inmeeting,boObj:mainAppHtmlWindow.inmeeting.boObj,intervalID:null,roomNum:mainAppHtmlWindow.inmeeting.boObj.roomNum,cloneNotStartTemp:$("#window-bo #bor_notstarted_temp").clone().removeAttr("id").removeClass("forceHide"),cloneInprogressTemp:$("#window-bo #bor_inprogress_temp").clone().removeAttr("id").removeClass("forceHide"),cloneUnassignTemp:$("#window-bo #bor_unassign_temp").clone().attr({id:"r_0"}).removeClass("forceHide"),cloneNotStartBtns:$("#window-bo #not_started").clone().removeClass("forceHide"),cloneInprogressBtns:$("#window-bo #in_progress").clone().removeClass("forceHide"),cloneBottomInfoJoin:$("#window-bo #bottom_info_join").clone().removeClass("forceHide"),cloneBottomInfoNotJoin:$("#window-bo #bottom_info_notjoin").clone().removeClass("forceHide")}),closeBoWins("boWin"),$("#window-bo #bor_notstarted_temp, #bor_inprogress_temp, #bor_unassign_temp, #in_progress, #bottom_info_join, #not_started, #in_progress, #bottom_info_notjoin").remove(),o(),$("#window-bo #bor_rooms").empty()}function o(){$("#window-bo .window-close").click(function(){clearInterval(f.intervalID),X(),closeBoWins()}),escEvt("#window-bo",function(){clearInterval(f.intervalID),X(),closeBoWins()}),function(){$("#window-bo #bor_rooms").unbind("click").click(function(){var o=$("#window-bo .bor-input").addClass("forceHide").parent("h3");hideAllBOWinExceptMainBoWin(),v(!1),w(o,!1)}),(mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp())&&$("#window-bo .panel-head").mousedown(function(){hideAllBOWinExceptMainBoWin()});mainAppHtmlWindow.winMgr.getWinByWinId("boWin")&&mainAppHtmlWindow.winMgr.getWinByWinId("boWin").onBoundsChanged.addListener(function(){hideAllBOWinExceptMainBoWin()})}(),O(f.cloneNotStartTemp),y(f.cloneNotStartTemp),O(f.cloneInprogressTemp),y(f.cloneInprogressTemp),O(f.cloneUnassignTemp),y(f.cloneUnassignTemp),f.cloneNotStartBtns.find(".bor-recreate").off("click").on("click",function(o){if(Q){Q=!1;var n=g(o);(function(o){closeBoWins("boWin",!0);var n=mainAppHtmlWindow.winMgr.getWinByWinId("createBoWin");n&&!1===i?(n.hide(),i=!0):n&&!0===i?(c(n,390,230,o.left,o.top),i=!1):mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp()?(mainAppHtmlWindow.createBo.showCreateBo(),mainAppHtmlWindow.createBo.bindRecallAllRoomsEvt(),mainAppHtmlWindow.createBo.recreateAllRooms(),$("#window-createBo").css({left:o.left+215,top:o.top+100,height:230})):mainAppHtmlWindow.winMgr.createWindow("createBoWin","build/window/bo/createBoWindow.html",{width:390,height:230,left:o.left,top:o.top},function(o){o.contentWindow.createBo.initCreateBoWindow(),o.contentWindow.createBo.bindRecallAllRoomsEvt(),o.contentWindow.createBo.recreateAllRooms()})})(n={left:n.left-215,top:n.top-235}),setTimeout(function(){Q=!0},500)}}),P(),f.cloneNotStartBtns.find(".bor-open-rooms").off("click").on("click",function(){Y()}),f.cloneInprogressBtns.find(".bor-close-all").off("click").on("click",function(){f.meeting.stopBO(),f.meeting.updateBoBadge(0),f.boObj.needUpdateBOWinUI=!0,po("close"),so()}),f.cloneInprogressBtns.find(".bor-broadcast").off("click").on("click",function(o){if(to){to=!1;var n=g(o);(function(o){closeBoWins("boWin",!0);var n=mainAppHtmlWindow.winMgr.getWinByWinId("broadcastBoWin");n&&!1===t?(n.hide(),t=!0):n&&!0===t?(n.contentWindow.broadcast.clearTextArea(),c(n,350,152,o.left,o.top),t=!1):mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp()?(mainAppHtmlWindow.broadcast.clearTextArea(),$("#window-broadcast").css({left:o.left,top:o.top,width:350,height:152}),$("#window-broadcast").hasClass("hideMe")?$("#window-broadcast").removeClass("hideMe"):$("#window-broadcast").addClass("hideMe"),mainAppHtmlWindow.broadcast.initBroadCastBoWindow()):(mainAppHtmlWindow.winMgr.createWindow("broadcastBoWin","build/window/bo/broadcastBoWindow.html",{width:350,height:152,left:o.left,top:o.top},function(o){o.contentWindow.broadcast.initBroadCastBoWindow()}),t=!1)})(n={left:n.left-200,top:n.top-165}),setTimeout(function(){to=!0},500)}}),f.cloneUnassignTemp.find("li").hover(function(){$(this).find(".bor-move-to").removeClass("forceHide")},function(){$(this).find(".bor-move-to").addClass("forceHide")}),f.cloneBottomInfoJoin.find(".bor-return-main-btn").click(function(){f.meeting.leaveBO(),closeBoWins()})}function n(){$("#window-bo").append(f.cloneNotStartBtns),V()}function d(){$("#window-bo").append(f.cloneInprogressBtns)}function e(){f.boObj.autoAssign?function(){for(var o,n,e=_.sortBy(f.boObj.attendees,[function(o){return o.userDisplayName}]),i=(a=void 0,s=void 0,l=void 0,c=void 0,m=void 0,a=f.boObj.attendees.length,s=parseInt(a),l=parseInt(f.roomNum),c=s%l,m=s/l,0!==c?[Math.floor(m),c]:[m,0]),t=i[0],r=i[1],d=0;d<f.roomNum;d++)o=D(),n=R(o,e,t);var a,s,l,c,m;r&&(p=n,$.each(p,function(o,n){var e="r_"+(o+1),i=$("#window-bo #"+e).find(".bor-title-oper"),t=parseInt(i.text());i.text(t+1),R(e,p,1)}));var p}():function(){for(var o=0;o<f.roomNum;o++)D()}(),n()}function c(o,n,e,i,t){o.outerBounds.setSize(n,e),o.outerBounds.setPosition(i,t),o.show(),o.focus()}var a=!1,s=!1,m=!1,l=!1,i=!1,t=!1,p=!1;function u(o){var n=$(o.target).parent("a");n.find("i").hasClass("bor-expand-arrow")?(n.find("i").removeClass("bor-expand-arrow").addClass("bor-collapse-arrow"),n.parentsUntil("div").siblings("ul").addClass("forceHide")):(n.find("i").removeClass("bor-collapse-arrow").addClass("bor-expand-arrow"),n.parentsUntil("div").siblings("ul").removeClass("forceHide"))}function w(o,n){n?o.find(".bor-rename").addClass("forceHide").end().find(".bor-del").addClass("forceHide").end().find(".bor-title-oper").addClass("forceHide"):o.find(".bor-title-oper").removeClass("forceHide")}function b(o){var e=$(o.target).parent("h3"),n=e.find(".bor-title").text();hideAllBOWinExceptMainBoWin(),e.find(".bor-input").val(n).removeClass("forceHide").on("click",function(o){o.stopPropagation()}).on("change",function(){var o=$(this),n=$.trim(o.val());""!==n&&e.find(".bor-title").text(n),o.addClass("forceHide"),v(!1),w(e,!1)}),v(!0),w(e,!0)}function g(o){var n=0,e=0;if(mainAppHtmlWindow.winMgr.getWinByWinId("boWin")){var i=mainAppHtmlWindow.winMgr.getWinByWinId("boWin").outerBounds,t=Math.round(i.left),r=Math.round(i.top),d=$(o.target).offset();n=t+Math.round(d.left)+100,e=r+Math.round(d.top)}else n=Math.round($(o.target).offset().left)+100,e=Math.round($(o.target).offset().top);return{left:n,top:e}}function W(o){var n=$(o.target).parents(".bor-sec").attr("id"),e=g(o);!function(o,n){closeBoWins("boWin",!0);var e=0,i=0,t=mainAppHtmlWindow.winMgr.getWinByWinId("delBoWin");if(t&&B===n&&!1===a)t.hide(),a=!0;else if(t)t.hide(),t.contentWindow.delBoContext={meeting:mainAppHtmlWindow.inmeeting,roomId:n},t.contentWindow.delBo.renderWin(),t.contentWindow.delBo.bindEvts(),e=t.contentWindow.document.documentElement.offsetWidth,i=t.contentWindow.document.documentElement.offsetHeight,c(t,e,i,o.left,o.top),a=!1;else if(mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp()){var r=$("#window-delBo");r.hasClass("hideMe")&&(r.removeClass("hideMe"),r.css({left:o.left,top:o.top}),mainAppHtmlWindow.delBo.initDelBoWindow(n))}else mainAppHtmlWindow.winMgr.createWindow("delBoWin",encodeURI("build/window/bo/delBoWindow.html"),{width:e,height:i,left:o.left,top:o.top},function(o){o.contentWindow.delBo.initDelBoWindow(n),o.outerBounds.width=o.contentWindow.document.documentElement.offsetWidth,o.outerBounds.height=o.contentWindow.document.documentElement.offsetHeight,i=o.outerBounds.width,e=o.outerBounds.height});B=n}({left:e.left,top:e.top},n)}function h(o){mainAppHtmlWindow.winMgr.getWinByWinId("assignBoWin");var n=g(o),e={type:null,roomId:$(o.target).parents(".bor-sec").attr("id")};!function(o,n){closeBoWins("boWin",!0);var e=mainAppHtmlWindow.winMgr.getWinByWinId("assignBoWin");if(e&&I===n.roomId&&!1===s)e.hide(),s=!0;else{var i=function(o){var n=mainAppHtmlWindow.inmeeting.getAttendeesFromBoItems(),e=[];_.forEach(n,function(o){e.push({userID:o.userID,userGUID:o.userGUID,userDisplayName:o.userDisplayName})});var i=f.boObj.allBOInfo.unassignedBoUsers;e=_.concat(e,i);var t=[],r=J(),d=K(o.roomId);return _.forEach(e,function(o){var n=o.userID.toString(),e=-1!==$.inArray(n,r),i=-1!==$.inArray(n,d);e&&!i||t.push({userID:o.userID,userGUID:o.userGUID,userDisplayName:o.userDisplayName})}),t}(n),t=70;0!==i.length&&(t=330<(t=33*i.length)?330:t),e?(e.hide(),e.contentWindow.assignBoContext={meeting:mainAppHtmlWindow.inmeeting,boObj:mainAppHtmlWindow.inmeeting.boObj,attendees:i,roomId:n.roomId,template:e.contentWindow.constAssignBoWinTemplate.clone().removeAttr("id").removeClass("forceHide")},e.contentWindow.assignBo.renderWin(),e.contentWindow.assignBo.bindEvts(),c(e,215,t,o.left,o.top),s=!1):mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp()?($("#window-assignBo").css({left:o.left,top:o.top,width:215,height:t}),$("#window-assignBo").removeClass("hideMe"),mainAppHtmlWindow.assignBo.initAssignBoWindow(void 0,n.roomId)):mainAppHtmlWindow.winMgr.createWindow("assignBoWin","build/window/bo/assignBoWindow.html",{width:215,height:t,left:o.left,top:o.top},function(o){o.contentWindow.assignBo.initAssignBoWindow(void 0,n.roomId)})}I=n.roomId}({left:n.left-20,top:n.top},e)}function v(o){o?$("#window-bo h3").unbind("mouseenter mouseleave"):$("#window-bo h3").hover(function(){x($(this))},function(){T($(this))})}var B,I,A,H,C=!0;function x(o){o.find(".bor-rename").removeClass("forceHide").end().find(".bor-del").removeClass("forceHide").end().off("click").on("click",function(o){o.stopPropagation();try{if(!C)return;C=!1,$(o.target).hasClass("bor-rename")?M(o,"bor-rename",b):$(o.target).hasClass("bor-del")?M(o,"bor-del",W):$(o.target).hasClass("bor-red")?M(o,"bor-red",lo):$(o.target).hasClass("bor-title-oper")?M(o,"bor-title-oper",f.meeting.isInprogress()?ao:f.meeting.isNew()||f.meeting.isEnded()?h:void 0):$(o.target).hasClass("bor-title")&&M(o,"bor-title",u),$(this).find("i").hasClass("bor-expand-arrow")?M(o,"bor-expand-arrow",u):M(o,"bor-collapse-arrow",u),setTimeout(function(){C=!0},500)}catch(o){}})}function T(o){o.find(".bor-rename").addClass("forceHide").end().find(".bor-del").addClass("forceHide").end().off("click")}function O(o){o.find("h3").hover(function(){x($(this))},function(){T($(this))})}function k(o){var n,e=o.parents(".bor-sec").attr("id");(n=z(e),!!_.find(n,function(o){return 0!==$("#window-bo #"+o.id).find("li").length}))?o.find(".bor-exchange").removeClass("forceHide"):o.find(".bor-exchange").addClass("forceHide").off("click")}function D(){var o=f.cloneNotStartTemp.clone(!0),n=$("#window-bo #bor_rooms div").last().attr("id"),e=n?parseInt(n.split("r_")[1])+1:1,i="r_"+e;return o.attr({id:i}).find(".bor-title").text("Breakout Rooms "+e).end().find("ul").empty().end().removeClass("forceHide").appendTo("#bor_rooms"),i}function N(o,n){var e=f.cloneNotStartTemp.find("li").clone(!0).attr({userid:n.userID,userguid:n.userGUID});e.find("#user_name").removeAttr("id").text(n.userDisplayName),$("#window-bo #"+o).find("ul").append(e)}function j(o){var n;o.find(".bor-exchange").removeClass("forceHide").end().off("click").on("click",function(o){M(o,"bor-exchange",U),M(o,"bor-move-to",E)}),n=o,1<f.roomNum?n.find(".bor-move-to").removeClass("forceHide"):n.find(".bor-move-to").addClass("forceHide").off("click"),k(o)}function y(o){o.find("li").hover(function(){j($(this))},function(){var o=$(this);o.find(".bor-exchange").addClass("forceHide").end().find(".bor-move-to").addClass("forceHide").end().off("click")})}function M(o,n,e){e&&($(o.target).hasClass(n)&&(e.apply(null,arguments),o.stopPropagation()))}function U(o){var n=$(o.target),e=g(o),i=n.parents(".bor-sec").attr("id"),t=n.parent("li").attr("userid"),r=z(i),d=r.length,a={roomId:i,attendeeId:t};if($.each(r,function(o,n){d+=n.attendees.length}),d){var s=30*d+6;(function(o,n,e){closeBoWins("boWin",!0);var i=mainAppHtmlWindow.winMgr.getWinByWinId("exchangeBoWin");if(i&&H===e.attendeeId&&!1===l)i.hide(),l=!0;else{if(i)i.hide(),i.contentWindow.exchangeBoContext={meeting:mainAppHtmlWindow.inmeeting,roomId:e.roomId,attendeeId:e.attendeeId,temp:i.contentWindow.constExchangeBoWinTemplate.clone()},i.contentWindow.exchangeBo.bindEvts(),i.contentWindow.exchangeBo.renderWin(),c(i,t,o,n.left,n.top),l=!1;else if(mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp())t=215,$("#window-exchangeBo").css({left:n.left,top:n.top,width:t,height:o}),mainAppHtmlWindow.exchangeBo.initExchangeBoWindow(e.roomId,e.attendeeId),$("#window-exchangeBo").removeClass("hideMe");else{var t=215;mainAppHtmlWindow.winMgr.createWindow("exchangeBoWin","build/window/bo/exchangeBoWindow.html",{width:t,height:o,left:n.left,top:n.top},function(o){o.contentWindow.exchangeBo.initExchangeBoWindow(e.roomId,e.attendeeId)})}H=e.attendeeId}})(s=300<s?300:s,{left:e.left-20,top:e.top},a)}}function E(o){var n=$(o.target),e=g(o),i=n.parents(".bor-sec").attr("id"),t=n.parent("li"),r=t.attr("userid"),d=t.attr("userguid"),a=z(i).length,s={roomId:i||"r_0",userid:r,userguid:d};if(a){var l=30*a;(function(o,n,e){closeBoWins("boWin",!0);var i=mainAppHtmlWindow.winMgr.getWinByWinId("moveToBoWin");if(i&&A===e.userid&&!1===m)i.hide(),m=!0;else if(i)i.hide(),i.contentWindow.moveToBoContext={meeting:mainAppHtmlWindow.inmeeting,boObj:mainAppHtmlWindow.inmeeting.boObj,roomId:e.roomId,userid:e.userid,userguid:e.userguid,roomTemp:i.contentWindow.constMoveToBoWinTemplate.clone().removeAttr("id")},i.contentWindow.moveToBo.renderWin(),i.contentWindow.moveToBo.bindEvts(),c(i,t,o,n.left,n.top),m=!1;else if(mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp())t=215,$("#window-moveToBo").css({left:n.left,top:n.top,width:t,height:o}),mainAppHtmlWindow.moveToBo.initMoveToBoWindow(e.roomId,e.userid,e.userguid),$("#window-moveToBo").removeClass("hideMe");else{var t=215;mainAppHtmlWindow.winMgr.createWindow("moveToBoWin","build/window/bo/moveToBoWindow.html",{width:t,height:o,left:n.left,top:n.top},function(o){o.contentWindow.moveToBo.initMoveToBoWindow(e.roomId,e.userid,e.userguid)})}A=e.userid})(l=300<l?300:l,{left:e.left-20,top:e.top},s)}}function S(o,n){var e=$("#window-bo #"+o).find("li").length,i=void 0===n?"Assign":"0";$("#window-bo #"+o).find(".bor-title-oper").text(0<e?e:i)}function R(o,n,e){for(var i=0;i<e;i++)N(o,n.shift());return $("#window-bo #"+o).find(".bor-title-oper").text(0<e?e:"Assign"),n}function P(){f.cloneNotStartBtns.find(".bor-add-room").off("click").on("click",function(){hideAllBOWinExceptMainBoWin(),D(),q(!0),50<=$("#window-bo #bor_rooms").find(".bor-sec").length&&$("#window-bo .bor-add-room").removeClass("bor-add-room").addClass("bor-add-room-disable").attr({tabindex:-1}).off("click")})}function G(n){var o=_.find(f.boObj.attendees,function(o){return n===o.userID.toString()});return f.boObj.unassignAttendees.push(o),o}function F(o,n){return 0!==$("#window-bo li[userid="+o+"]").length}function J(){var o=$("#window-bo li[userid]"),n=[];return _.forEach(o,function(o){n=_.concat(n,$(o).attr("userid"))}),n}function K(o){var n=[];return $("#window-bo #"+o).find("li").each(function(){n.push($(this).attr("userid"))}),n}function L(){var t=[];return $("#window-bo .bor-sec").each(function(){var o,i,n=$(this).attr("id"),e={id:n,bid:$(this).attr("bid"),meetingtoken:$(this).attr("meetingtoken"),roomName:$(this).find(".bor-title").text(),attendees:(o=n,i=[],$("#window-bo #"+o).find("li").each(function(){var o=$(this).attr("userid"),n=$(this).attr("userguid"),e=$(this).find("span").text();i.push({userID:o,userGUID:n,userDisplayName:e})}),i)};t.push(e)}),t}function z(n){var o=L();return _.filter(o,function(o){return o.id!==n})}function q(o){o?++f.roomNum:--f.roomNum}var Q=!0;function V(){var o=!!$("#window-bo .bor-sec").find("li").length,n=!!$("#window-bo .bor-open-rooms").length;(o||n)&&(o&&n||(o&&!n&&$("#window-bo .bor-open-disable").removeClass("bor-open-disable").addClass("bor-open-rooms").removeAttr("tabindex").off("click").on("click",function(){Y()}),!o&&n&&$("#window-bo .bor-open-rooms").removeClass("bor-open-rooms").addClass("bor-open-disable").off("click").attr({tabindex:-1})))}function X(){var o=L();return f.boObj.boRooms=o}function Y(){var t,o,n=(t=[],o=X(),$.each(o,function(o,n){var e,i=[];$.each(n.attendees,function(o,n){i.push(n.userGUID)}),e={BOName:n.roomName,userGUIDList:i},t.push(e)}),t);f.boObj.needUpdateBOWinUI=!0,f.meeting.createBO(n),po("open")}function Z(o,n){var e,i=o.find(".bor-join").clone(!0),t=o.find(".bor-notjoin").clone(!0);return n.BOUserStatus?"1"===n.BOUserStatus.toString()?e=t:"2"===n.BOUserStatus.toString()&&(e=i):e=t,e}function oo(){var e,i=f.cloneUnassignTemp.clone(!0),o=f.boObj.allBOInfo.unassignedBoUsers;if(o.length){i.find(".bor-badge").text(o.length);var n=f.cloneUnassignTemp.clone(!0);e=n.find("ul").empty(),_.forEach(o,function(o){var n=Z(i,o);n&&(n.attr({userid:o.userID,userguid:o.userGUID}).find("#user_name").text(o.userDisplayName).removeAttr("id"),n.appendTo(e))}),$("#window-bo #bor_rooms").prepend(n),f.meeting.updateBoBadge(o.length)}else f.meeting.updateBoBadge(0)}function no(){var o=f.meeting.isInprogress()?" - In Progress":" - Not Started";$("#window-bo #bor_head_text").text(o)}function eo(){var o;clearInterval(f.intervalID),no(),oo(),o=f.boObj.allBOInfo.boItems,f.roomNum=o.length,$.each(o,function(o,n){var e=f.cloneInprogressTemp.clone(!0);co(e.attr({id:"r_"+(o+1),bid:n.BID,meetingtoken:n.meetingToken}).find(".bor-title").text(n.meetingName).end().find("ul").empty(),n),$("#window-bo #bor_rooms").append(e)}),d()}var io,to=!0;function ro(o,n){closeBoWins("boWin",!0);var e=mainAppHtmlWindow.winMgr.getWinByWinId("joinleaveBoPromptWin");if(e&&io===n.bid&&!1===p)e.hide(),p=!0;else if(e)e.hide(),e.contentWindow.joinLeaveBoPromptContext={meeting:mainAppHtmlWindow.inmeeting,bid:n.bid,roomName:n.roomName,type:n.type},e.contentWindow.joinLeaveBoPrompt.renderWin(),e.contentWindow.joinLeaveBoPrompt.bindEvts(),c(e,i,t,o.left-20,o.top),p=!1;else if(mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp())i=220,t=80,$("#window-joinleaveBoPrompt").css({left:o.left-20,top:o.top,width:i,height:t}),$("#window-joinleaveBoPrompt").removeClass("hideMe"),mainAppHtmlWindow.joinLeaveBoPrompt.initJoinLeaveBoPromptWindow(n.bid,n.roomName,n.type);else{var i=220,t=80;mainAppHtmlWindow.winMgr.createWindow("joinleaveBoPromptWin",encodeURI("build/window/bo/joinleaveBoPromptWindow.html"),{width:i,height:t,left:o.left-20,top:o.top},function(o){o.contentWindow.joinLeaveBoPrompt.initJoinLeaveBoPromptWindow(n.bid,n.roomName,n.type)})}io=n.bid}function ao(o){var n=$(o.target).parents(".bor-sec"),e=n.attr("bid"),i=n.find(".bor-title").text();ro(g(o),{bid:e,roomName:i,type:"j"})}function so(){var o=mainAppHtmlWindow.g.getMeetingStatusObj().inBO&&f.boObj.boHost.gotHost?"hostJoin":$("#window-bo .bor-join").length?"attendeeJoin":"none",n="hostJoin"===o?f.cloneBottomInfoJoin:"attendeeJoin"===o?f.cloneBottomInfoNotJoin:null;n&&($("#window-bo #in_progress").remove(),$("#window-bo").append(n),$("#window-bo .bor-sec").each(function(){S($(this).attr("id"),0)}),$("#window-bo .bor-title-oper").addClass("bor-disable"),$("#window-bo h3, li, #bor_rooms").off(),$("#window-bo h3").on("click",function(o){M(o,"bor-title",u),$(this).find("i").hasClass("bor-expand-arrow")?M(o,"bor-expand-arrow",u):M(o,"bor-collapse-arrow",u)}))}function lo(o){var n=$(o.target).parents(".bor-sec"),e=n.attr("bid"),i=n.find(".bor-title").text();ro(g(o),{bid:e,roomName:i,type:"l"})}function co(e,o){_.forEach(o.BOUserItems,function(o){var n=Z(f.cloneInprogressTemp,o);n&&n.attr({userid:o.userID,userguid:o.userGUID}).find("#user_name").text(o.userDisplayName).removeAttr("id").end().appendTo(e)})}function mo(){f.intervalID=setInterval(function(){var o,n,i,e,t,r,d=_.concat(mainAppHtmlWindow.inmeeting.getAttendeesFromBoItems(),f.boObj.allBOInfo.unassignedBoUsers),a=f.boObj.attendees,s=f.boObj.unassignAttendees;n=a,i=d,e=_.concat(n),_.remove(e,function(n){var o,e;_.find(i,function(o){return n.userID===o.userID})||(e=(o=$("#window-bo li[userid="+n.userID+"]")).parents(".bor-sec").attr("id"),o.remove(),S(e))}),o=_.differenceBy(d,a,"userID"),f.boObj.attendees=d,f.boObj.unassignAttendees=_.concat(s,o),t=f.boObj.attendees,r=f.boObj.unassignAttendees,_.remove(r,function(n){return!_.find(t,function(o){return o.userID===n.userID})})},1e3)}function po(n){var o=Math.round(screen.availWidth-350-10),e=mainAppHtmlWindow.winMgr.getWinByWinId("boTooltipWin1"),i=e?"2":"1",t=e?120:50;mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp()?($("#window-boTooltip").css({left:o,top:t,width:350,height:67}),mainAppHtmlWindow.boTooltip.initBoTooltipWindow(),"open"===n?mainAppHtmlWindow.boTooltip.showOpenAllInfo():mainAppHtmlWindow.boTooltip.showCloseAllInfo(),$("#window-boTooltip").removeClass("hideMe")):mainAppHtmlWindow.winMgr.createWindow("boTooltipWin"+i,"build/window/bo/boTooltipWindow.html",{width:350,height:67,left:o,top:t},function(o){o.contentWindow.boTooltip.initBoTooltipWindow(),"open"===n?o.contentWindow.boTooltip.showOpenAllInfo():o.contentWindow.boTooltip.showCloseAllInfo()})}return{assignAttendeeToRoom:function(o,n){var e,i=(e=o,_.remove(f.boObj.unassignAttendees,function(o){return e===o.userID.toString()})[0]);F(o)||(N(n,i),(f.meeting.isNew()||f.meeting.isEnded())&&S(n))},attendeeAssigned:F,attendeeAssignedInBO:J,execute:function(){r(),e(),mo()},executeRecover:function(){var o;r(),o=f.boObj.boRooms,$("#window-bo #bor_rooms").empty(),_.forEach(o,function(o){var n=f.cloneNotStartTemp.clone(!0).attr({id:o.id,bid:o.bid,meetingtoken:o.meetingtoken}).find(".bor-title").text(o.roomName).end(),e=n.find("li").clone(!0),i=n.find("ul").empty();_.forEach(o.attendees,function(o){e.attr({userid:o.userID,userguid:o.userGUID}).find("#user_name").removeAttr("id").text(o.userDisplayName).end().appendTo(i)}),n.appendTo("#bor_rooms"),S(o.id)}),n(),V(),mo()},executeEnded:function(){var o;r(),o=f.boObj.allBOInfo.boItems,f.roomNum=o.length,no(),$.each(o,function(o,n){var e,i,t,r=f.cloneNotStartTemp.clone(!0),d="r_"+(o+1),a=r.attr({id:d,bid:n.BID,meetingtoken:n.meetingToken}).find(".bor-title").text(n.meetingName).end().find("ul").empty();e=n,i=a,t=f.cloneNotStartTemp.find("li").clone(!0),_.forEach(e.BOUserItems,function(o){var n=t.clone(!0);n.attr({userid:o.userID,userguid:o.userGUID}).find("#user_name").text(o.userDisplayName).removeAttr("id").end().appendTo(i)}),f.roomCount=o+1,$("#window-bo #bor_rooms").append(r),S(d)}),n(),V(),mo()},executeInBOMeeting:function(){var o,i,n,e,t;r(),clearInterval(f.intervalID),no(),oo(),n=f.boObj.allBOInfo.boItems,e=f.boObj.boHost.hostGUID,o=_.orderBy(n,function(o){var n=_.find(o.BOUserItems,function(o){return e===o.userGUID});return!!n},"desc"),i=[],$.each(o,function(o,n){var e=f.cloneInprogressTemp.clone();i=_.concat(i,n.BOUserItems),co(e.attr({id:"r_"+(o+1),bid:n.BID,meetingtoken:n.meetingToken}).find(".bor-title").text(n.meetingName).end().find("ul").empty(),n),$("#window-bo #bor_rooms").append(e)}),o.length&&(f.roomNum=o.length,t=o[0].BID,$('#window-bo div[bid="'+t+'"]').find(".bor-title-oper").addClass("bor-red").text("Leave")),d()},executeInprogress:function(){r(),eo()},executeStopping:function(){r(),eo(),so()},exchangeAttendeeToRoom:function(o,n,e,i){var t=$("#window-bo li[userid="+o+"]").clone(!0),r=$("#window-bo li[userid="+n+"]").clone(!0);$("#window-bo li[userid="+o+"]").remove(),$("#window-bo li[userid="+n+"]").remove(),$("#window-bo #"+e).find("ul").append(r),$("#window-bo #"+i).find("ul").append(t)},enableAddRoomBtn:function(){$("#window-bo .bor-add-room-disable").length&&($("#window-bo .bor-add-room-disable").removeClass("bor-add-room-disable").addClass("bor-add-room").removeAttr("tabindex"),P())},filterRoomsById:z,getRoomNameByRoomId:function(o){return $("#window-bo #"+o).find(".bor-title").text()},getAttendeeIdsByRoomId:K,moveAttendeeToRoom:function(o,n,e){var i=$("#window-bo li[userid="+o+"]"),t=i.clone(!0);i.remove(),$("#window-bo #"+e).find("ul").append(t),S(n),S(e)},updateRoomNum:q,updateOpenAllRoomsBtn:V,resetAllBOWinHiddenFlag:function(o){p=t=i=l=m=s=a=!0},recreateBoWindow:function(){$("#window-bo .bor-sec").remove(),f.boObj=mainAppHtmlWindow.inmeeting.boObj,f.roomNum=mainAppHtmlWindow.inmeeting.boObj.roomNum,o(),e()},removeRoomByRoomId:function(o){$("#window-bo #"+o).find("li").each(function(){G($(this).attr("userid"))}),$("#window-bo #"+o).remove()},removeAttendee:function(o,n){G(o),$("#window-bo #"+n).find("li[userid="+o+"]").remove(),(f.meeting.isNew()||f.meeting.isEnded())&&S(n)},showBo:function(o){var n=mainAppHtmlWindow.winMgr.getWinByWinId("boWin");mainAppChromeWindow.isFullscreen()||mainAppHtmlWindow.backgroundWindow.isKioskApp()?(n&&n.close(),mainAppHtmlWindow.client.toggleDivWindow("window-bo"),"function"==typeof o&&o.call(null,mainAppChromeWindow)):n?n.focus():mainAppHtmlWindow.inmeeting.createBoWindow(o)},updateCountDown:function(o){$("#window-bo #sec").text(o)}}}();